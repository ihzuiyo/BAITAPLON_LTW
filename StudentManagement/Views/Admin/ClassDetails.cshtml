@model StudentManagement.Models.Class
@{
    ViewData["Title"] = "Chi Tiết Lớp: " + Model.ClassName;
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="dashboard-header">
    <h1 class="page-title"><i class="fas fa-info-circle"></i> Chi Tiết Lớp: @Model.ClassName</h1>
    <div class="header-actions">
        <a asp-action="Classes" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Quay lại Danh sách Lớp
        </a>
        <a asp-action="EditClass" asp-route-id="@Model.ClassId" class="btn btn-primary">
            <i class="fas fa-edit"></i> Chỉnh Sửa
        </a>
    </div>
</div>

<div class="row">
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white"><i class="fas fa-clipboard-list"></i> Thông Tin Cơ Bản</div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-sm-4">Mã Lớp:</dt>
                    <dd class="col-sm-8"><span class="badge bg-secondary">@Model.ClassCode</span></dd>

                    <dt class="col-sm-4">Tên Lớp:</dt>
                    <dd class="col-sm-8"><strong>@Model.ClassName</strong></dd>

                    <dt class="col-sm-4">Khóa Học:</dt>
                    <dd class="col-sm-8">@Model.Course?.CourseName</dd>

                    <dt class="col-sm-4">Học Phí:</dt>
                    <dd class="col-sm-8">
                        @if (Model.Course != null)
                        {
                            <span>@Model.Course.TuitionFee.ToString("N0") VNĐ</span>
                        }
                    </dd>

                    <dt class="col-sm-4">Sĩ Số Tối Đa:</dt>
                    <dd class="col-sm-8">@Model.MaxStudents</dd>

                    <dt class="col-sm-4">Số lượng Đã Đăng Ký:</dt>
                    <dd class="col-sm-8">
                        <span class="text-success">@Model.Enrollments.Count</span> / @Model.MaxStudents
                    </dd>
                </dl>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header bg-info text-white"><i class="fas fa-chalkboard-teacher"></i> Giảng Viên Phụ Trách</div>
            <div class="card-body">
                @if (Model.Teacher != null)
                {
                    <p><strong>@Model.Teacher.FirstName @Model.Teacher.LastName</strong> (@Model.Teacher.TeacherCode)</p>
                    <p><i class="fas fa-phone"></i> @Model.Teacher.PhoneNumber</p>
                    <p><i class="fas fa-envelope"></i> @Model.Teacher.Email</p>
                    <p><i class="fas fa-graduation-cap"></i> Chuyên môn: @Model.Teacher.Specialization</p>
                }
                else
                {
                    <p class="text-muted">Chưa phân công giảng viên.</p>
                }
            </div>
        </div>
    </div>

    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header bg-warning text-dark"><i class="fas fa-calendar-alt"></i> Lịch Học</div>
            <div class="card-body">
                @if (Model.ClassSchedules.Any())
                {
                    <ul class="list-group list-group-flush">
                        @foreach (var schedule in Model.ClassSchedules.OrderBy(s => s.Weekday))
                        {
                            <li class="list-group-item">
                                <strong>@schedule.Weekday</strong>:
                                @schedule.StartTime.ToString("HH:mm") - @schedule.EndTime.ToString("HH:mm")
                                (@schedule.Room?.RoomName)
                            </li>
                        }
                    </ul>
                }
                else
                {
                    <p class="text-muted">Chưa có lịch học chính thức.</p>
                }
            </div>
        </div>

        <div class="card">
            <div class="card-header bg-success text-white">
                <i class="fas fa-users"></i> Danh Sách @Model.Enrollments.Count Sinh Viên
            </div>
            <div class="card-body">
                @if (Model.Enrollments.Any())
                {
                    <table class="table table-sm table-striped">
                        <thead>
                            <tr>
                                <th>Mã SV</th>
                                <th>Họ Tên</th>
                                <th>Ngày Ghi Danh</th>
                                <th>Trạng Thái</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var enrollment in Model.Enrollments.OrderBy(e => e.EnrollmentDate))
                            {
                                var student = enrollment.Student;
                                <tr>
                                    <td>@student.StudentCode</td>
                                    <td>@student.FullName</td>
                                    <td>@enrollment.EnrollmentDate.ToString("dd/MM/yyyy")</td>
                                    <td>
                                        <span class="badge bg-primary">@enrollment.Status</span>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }
                else
                {
                    <p class="text-muted">Lớp chưa có sinh viên ghi danh.</p>
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Thêm script nếu cần cho việc tương tác
    </script>
}